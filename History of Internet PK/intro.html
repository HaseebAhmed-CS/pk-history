<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Internet in Pakistan — Introduction</title>

  <!-- Nunjucks -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/nunjucks/3.2.4/nunjucks.min.js"></script>

  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;900&family=JetBrains+Mono:wght@400;500;700&display=swap" rel="stylesheet">

  <style>
    :root{
      /* Light theme (matches landing) */
      --bg:#ffffff;
      --bg-soft:#f6faf8;
      --ink:#0f1720;
      --muted:#3a4e46;
      --border:#e5efe9;

      --green:#10b981;         /* primary */
      --green-600:#059669;
      --green-700:#047857;
      --cyan:#22d3ee;

      --shadow-1:0 1px 2px rgba(16,24,32,.06), 0 8px 24px rgba(16,24,32,.06);
      --shadow-2:0 6px 18px rgba(16,24,32,.08), 0 18px 46px rgba(16,24,32,.10);

      --r-md:16px; --r-lg:24px; --r-xl:28px;
      --container:1200px;

      --step-0:clamp(.95rem,.9rem + .2vw,1rem);
      --step-1:clamp(1.1rem,1rem + .6vw,1.25rem);
      --step-2:clamp(1.35rem,1.1rem + 1.2vw,1.75rem);
      --step-3:clamp(1.8rem,1.4rem + 2vw,2.25rem);
      --step-4:clamp(2.2rem,1.8rem + 3vw,3.2rem);
      --step-5:clamp(2.8rem,2.2rem + 4vw,4.2rem);
    }
    *{box-sizing:border-box}
    html{scroll-behavior:smooth}
    body{
      margin:0;background:var(--bg);color:var(--ink);
      font-family:'Inter',system-ui,-apple-system,Segoe UI,Roboto,sans-serif; line-height:1.65;
      -webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;
    }
    .container{max-width:var(--container);margin:auto;padding:0 24px}

    /* Chip */
    .chip{display:inline-flex;gap:.5rem;align-items:center;padding:.38rem .7rem;
      background:#ecfdf5;border:1px solid #d1fae5;color:#065f46;border-radius:999px;
      font-weight:700;font-size:.8rem}

    /* ---------- Loading ---------- */
    .loading{display:flex;min-height:60vh;align-items:center;justify-content:center;flex-direction:column;gap:14px}
    .spinner{width:46px;height:46px;border:3px solid rgba(16,24,32,.08);border-top:3px solid var(--green);border-radius:50%;animation:spin 1s linear infinite}
    @keyframes spin{to{transform:rotate(360deg)}}
    .loading p{color:#4b6359}

    /* ---------- Hero ---------- */
    .hero{
      position:relative; overflow:hidden; isolation:isolate;
      background:var(--bg-soft);
      border-bottom:1px solid var(--border);
    }
    .hero-inner{padding:72px 0}
    .hero-flag{
      position:absolute; inset:0; z-index:-2; opacity:.88;
      background:url('https://upload.wikimedia.org/wikipedia/commons/3/32/Flag_of_Pakistan.svg') center/cover no-repeat;
    }
    .hero-veiling{
      position:absolute; inset:-1px; z-index:-1;
      background:linear-gradient(180deg,rgba(255,255,255,.8),rgba(255,255,255,.92));
    }
    .hero h1{font-size:var(--step-5);margin:.2rem 0 .6rem;font-weight:900;letter-spacing:-.02em}
    .hero p{max-width:760px;color:var(--muted);font-size:var(--step-1);margin:0}

    /* ---------- Sections ---------- */
    .section{padding:64px 0}
    .section-header{text-align:center;margin-bottom:28px}
    .kicker{letter-spacing:.12em;text-transform:uppercase;font-weight:800;color:var(--green-700);font-size:.8rem}
    .title{font-size:var(--step-3);margin:.25rem 0}
    .lead{max-width:820px;margin:8px auto 0;color:#3c4e47;font-size:var(--step-1)}

    /* ---------- Highlights Grid ---------- */
    .grid{display:grid;grid-template-columns:repeat(2,1fr);gap:20px}
    .card{
      background:#fafff9;border:1px solid var(--border);border-radius:var(--r-xl);
      padding:24px; box-shadow:var(--shadow-1); transition:transform .25s ease, box-shadow .25s ease;
    }
    .card:hover{transform:translateY(-6px); box-shadow:var(--shadow-2)}
    .hi-icon{font-size:1.7rem;display:block;margin-bottom:10px}
    .hi-year{font-family:'JetBrains Mono',monospace;color:var(--green-700);font-weight:900;font-size:.9rem;margin-bottom:2px}
    .hi-title{color:var(--green-700);font-weight:800;margin:.2rem 0 .4rem}
    .hi-detail{color:#3c4e47}

    /* ---------- Facts ---------- */
    .facts{
      background:#fff;border:1px solid var(--border);border-radius:var(--r-xl);
      box-shadow:var(--shadow-1); padding:32px;
    }
    .facts ul{list-style:none;max-width:880px;margin:16px auto 0;padding:0}
    .facts li{
      position:relative; padding:14px 16px 14px 42px; margin:8px 0;
      background:var(--bg-soft); border:1px solid var(--border); border-radius:16px; color:#355048;
    }
    .facts li::before{
      content:""; position:absolute; left:14px; top:50%; transform:translateY(-50%);
      width:20px; height:20px; border-radius:50%;
      background:conic-gradient(from 0deg, var(--green) 0 75%, #d1fae5 0);
      box-shadow:inset 0 0 0 3px #ecfdf5;
    }

    /* ---------- CTA ---------- */
    .cta{
      background:linear-gradient(180deg,#ffffff,#f6fbf9);
      border:1px solid var(--border); border-radius:var(--r-xl); box-shadow:var(--shadow-1);
      padding:36px; text-align:center;
    }
    .cta h3{font-size:var(--step-2); color:#065f46; margin:.2rem 0 1rem}
    .cta ul{list-style:none; padding:0; margin:0 auto; max-width:840px; text-align:left}
    .cta li{padding-left:28px; position:relative; margin:10px 0; color:#3b5148}
    .cta li::before{content:"→"; position:absolute; left:0; top:0; color:var(--green-700); font-weight:900}

    /* ---------- Footer ---------- */
    footer{border-top:1px solid var(--border); background:var(--bg-soft); margin-top:64px}
    .foot{padding:26px 0; text-align:center; color:#3c4e47}
    .foot strong{color:var(--green-700)}

    /* ---------- Responsive ---------- */
    @media (max-width:1024px){ .grid{grid-template-columns:repeat(2,1fr)} }
    @media (max-width:640px){
      .hero-inner{padding:56px 0}
      .grid{grid-template-columns:1fr}
    }

    /* Scroll-reveal (applied inline via JS) */
  </style>
</head>
<body>
  <!-- Loading -->
  <div id="loading" class="loading" role="status" aria-live="polite">
    <div class="spinner" aria-hidden="true"></div>
    <p>Loading Pakistan’s digital story…</p>
  </div>

  <!-- Render target -->
  <div id="intro-content" hidden></div>

  <!-- Nunjucks template -->
  <script type="text/template" id="intro-template">
    <header class="hero">
      <div class="hero-flag" aria-hidden="true"></div>
      <div class="hero-veiling" aria-hidden="true"></div>
      <div class="container hero-inner">
        <span class="chip">Pakistan · 1995 → 2025</span>
        <h1>{{ hero.headline }}</h1>
        {% if hero.subhead %}<p>{{ hero.subhead }}</p>{% endif %}
      </div>
    </header>

    <main class="container">
      <section class="section">
        <div class="section-header">
          <span class="kicker">Introduction</span>
          <h2 class="title">{{ welcome.title }}</h2>
          {% if welcome.lead %}<p class="lead">{{ welcome.lead }}</p>{% endif %}
        </div>

        {% for paragraph in welcome.paragraphs %}
          <p class="lead" style="max-width:860px;text-align:left;margin-top:14px">{{ paragraph }}</p>
        {% endfor %}
      </section>

      <section class="section">
        <div class="section-header">
          <span class="kicker">Milestones</span>
          <h2 class="title">Key Moments</h2>
          <p class="lead">Early connections, infrastructure leaps, and culture-shaping platforms.</p>
        </div>

        <div class="grid">
          {% for h in highlights %}
            <article class="card reveal">
              {% if h.icon %}<span class="hi-icon" aria-hidden="true">{{ h.icon }}</span>{% endif %}
              <div class="hi-year">{{ h.year }}</div>
              <h3 class="hi-title">{{ h.title }}</h3>
              <p class="hi-detail">{{ h.detail }}</p>
            </article>
          {% endfor %}
        </div>
      </section>

      <section class="section">
        <div class="section-header">
          <span class="kicker">By the Numbers</span>
          <h2 class="title">{{ facts.title }}</h2>
          {% if facts.lead %}<p class="lead">{{ facts.lead }}</p>{% endif %}
        </div>
        <div class="facts reveal">
          <ul>
            {% for f in facts.list %}
              <li>{{ f }}</li>
            {% endfor %}
          </ul>
        </div>
      </section>

      <section class="section">
        <div class="cta reveal">
          <h3>{{ cta.headline }}</h3>
          <ul>
            {% for p in cta.points %}<li>{{ p }}</li>{% endfor %}
          </ul>
        </div>
      </section>
    </main>

    <footer>
      <div class="container foot">
        <div><strong>{{ footer.credits }}</strong></div>
        <div>{{ footer.author }}</div>
        <div style="color:#5a6b64;font-size:.9rem">{{ footer.year }}</div>
      </div>
    </footer>
  </script>

  <script>
    nunjucks.configure({ autoescape: true });

    async function loadContent() {
      const loading = document.getElementById('loading');
      const target = document.getElementById('intro-content');
      const tpl = document.getElementById('intro-template').innerHTML;

      // Fallback dataset (used if fetch fails)
      const fallback = {
        hero: {
          headline: "Internet in Pakistan — Origins",
          subhead: "How early gateways, ISPs and university links brought Pakistan online."
        },
        welcome: {
          title: "From Gateways to a Nation Online",
          lead: "The 1990s laid the pipes: academic networks, early ISPs, and a public that first met the web via cafés and dial‑up.",
          paragraphs: [
            "Before broadband, Pakistan’s first experiences of the internet came through university labs and pioneering service providers. Email gateways and dial‑up nodes connected research groups and early adopters.",
            "As infrastructure matured, access expanded beyond campuses. Internet cafés flourished, and policy shaped how citizens and businesses could come online."
          ]
        },
        highlights: [
          { icon: "🛰️", year: "1995", title: "Public Internet Launch", detail: "The first commercial access arrives; universities and ISPs open the door." },
          { icon: "☎️", year: "1998", title: "Dial‑Up Boom", detail: "Cafés and homes go online at 56k—slow, but transformative." },
          { icon: "🌐", year: "2001", title: "Local Content", detail: "News, forums and portals draw diaspora and local communities together." }
        ],
        facts: {
          title: "Foundations That Scaled",
          lead: "The early stack set the stage for broadband and mobile eras.",
          list: [
            "First public access in the mid‑1990s via national gateways.",
            "Dial‑up pricing + café culture drove initial adoption.",
            "Universities and tech communities seeded local talent."
          ]
        },
        cta: {
          headline: "Next: how Pakistan leapt from dial‑up to DSL and beyond",
          points: [
            "Explore the 2000s infrastructure push & policy environment.",
            "See the timeline from DSL to 3G/4G spectrum auctions.",
            "Understand how broadband unlocked new industries."
          ]
        },
        footer: {
          credits: "CM1040 Web Development — Internet in Pakistan",
          author: "Created by Aamir Mustafa · Goldsmiths, University of London",
          year: "© 2025"
        }
      };

      try {
        loading.style.display = "flex";
        target.hidden = true;

        const resp = await fetch("data/intro.json", { cache: "no-store" });
        const data = resp.ok ? await resp.json() : fallback;

        const html = nunjucks.renderString(tpl, data || fallback);
        target.innerHTML = html;

        loading.style.display = "none";
        target.hidden = false;

        // subtle reveal
        applyReveal();
      } catch (e) {
        const html = nunjucks.renderString(tpl, fallback);
        target.innerHTML = html;
        loading.style.display = "none";
        target.hidden = false;
        applyReveal();
        console.warn("Intro JSON failed, using fallback:", e);
      }
    }

    function applyReveal(){
      const els = document.querySelectorAll(".reveal, .card");
      els.forEach(el=>{
        el.style.opacity = "0";
        el.style.transform = "translateY(10px)";
      });
      const io = new IntersectionObserver((entries)=>{
        entries.forEach(en=>{
          if(en.isIntersecting){
            en.target.style.transition = "opacity .55s ease, transform .55s cubic-bezier(.2,.8,.2,1)";
            en.target.style.opacity = "1";
            en.target.style.transform = "translateY(0)";
            io.unobserve(en.target);
          }
        });
      },{threshold:.12});
      els.forEach(el=>io.observe(el));
    }

    document.addEventListener("DOMContentLoaded", loadContent);

    // Smooth internal links
    document.addEventListener("click", (e)=>{
      const a = e.target.closest("a[href^='#']");
      if(!a) return;
      e.preventDefault();
      const tgt = document.querySelector(a.getAttribute("href"));
      if(tgt) tgt.scrollIntoView({ behavior:"smooth", block:"start" });
    });
  </script>
</body>
</html>
